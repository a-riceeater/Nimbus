<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Editor</title>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <div id="line-numbers">
        <div></div>
    </div>
    <pre><code id="code-editor" class="language-javascript" contenteditable="true" spellcheck="false" autofocus="true">
        console.log("hi")
    </code></pre>
    <script>
        try {
            hljs.initHighlightingOnLoad();

            document.getElementById("code-editor").addEventListener("input", (e) => {
                hljs.highlightAll();
                placeCaretAtEnd(document.getElementById("code-editor"))
            })
        }
        catch (err) {
            alert(err);
        }
        function placeCaretAtEnd(el) {
            el.focus();

            if (
                typeof window.getSelection != "undefined" &&
                typeof document.createRange != "undefined"
            ) {
                var range = document.createRange();
                var sel = window.getSelection();

                if (el.lastChild && el.lastChild.nodeName == "BR") {
                    range.setStartBefore(el.lastChild);
                    range.setEndBefore(el.lastChild);
                } else {
                    range.selectNodeContents(el);
                    range.collapse(false);
                }

                sel.removeAllRanges();
                sel.addRange(range);
            } else if (typeof document.body.createTextRange != "undefined") {
                var textRange = document.body.createTextRange();
                textRange.moveToElementText(el);
                textRange.collapse(false);
                textRange.select();
            }
        }
    </script>
</body>

</html>